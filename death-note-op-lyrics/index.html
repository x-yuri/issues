<!doctype html>
<html>
<head>
    <style>
        /*
        .word {
            border-bottom-: 1px solid #999;
            margin-left-: 2px;
        }
        .word:first-child {
            margin-left-: 0;
        }
        ruby {
            ruby-align-: start;
        }
        */
        a {
            color: #000;
            margin-left: 2px;
        }
        a:first-child {
            maring-left: 0;
        }
        .controls {
            position: fixed;
            right: 0;
            top: 0;
            padding: 8px;
        }
    </style>
</head>
<body>
    <div class="controls">
        <label>
            <input type="radio" name="ruby" value="hiragana">
            hiragana
            </label>
        <label>
            <input type="radio" name="ruby" value="translation">
            translation
            </label>
    </div>
    <p class="jp">
        <a href="https://jisho.org/word/%E5%BA%83%E3%81%8C%E3%82%8B"
            ><ruby
                ><span class="base">広</span
                ><rp>(</rp><rt>ひろ</rt><rp>)</rp
            ></ruby
            >がる</a
        ><a href="https://jisho.org/word/%E9%97%87"
            ><ruby
                ><span class="base">闇</span
                ><rp>(</rp><rt>やみ</rt><rp>)</rp
            ></ruby></a
        ><a href="https://jisho.org/word/%E3%81%AE"
            >の</a
        ><a href="https://jisho.org/word/%E4%B8%AD"
            ><ruby
                ><span class="base">中</span
                ><rp>(</rp><rt>なか</rt><rp>)</rp
            ></ruby></a
        ><a href="https://jisho.org/word/%E4%BA%A4%E3%82%8F%E3%81%97%E5%90%88%E3%81%86"
            ><ruby
                ><span class="base">交</span
                ><rp>(</rp><rt>か</rt><rp>)</rp
            ></ruby
            >わし<ruby
                ><span class="base">合</span
                ><rp>(</rp><rt>あ</rt><rp>)</rp
            ></ruby
            >った</a
        ><a href="https://jisho.org/word/%E9%9D%A9%E5%91%BD"
            ><ruby
                ><span class="base">革命</span
                ><rp>(</rp><rt>かくめい</rt><rp>)</rp
            ></ruby></a
        ><a href="https://jisho.org/word/%E3%81%AE"
            >の</a
        ><a href="https://jisho.org/word/%E5%A5%91%E3%82%8A"
            ><ruby
                ><span class="base">契</span
                ><rp>(</rp><rt>ちぎ</rt><rp>)</rp
            ></ruby
            >り</a>
    <p>In the shadows that keep expanding, we exchange revolutionary vows.

    <p class="jp">
        <a href="https://jisho.org/word/%E8%AA%B0"
            ><ruby
                ><span class="base">誰</span
                ><rp>(</rp><rt>だれ</rt><rp>)</rp
            ></ruby
        ></a
        ><a href="https://jisho.org/word/%E3%81%AB"
            >に</a
        ><a href="https://jisho.org/word/%E3%82%82"
            >も</a
        ><a href="https://jisho.org/word/%E9%82%AA%E9%AD%94"
            ><ruby
                ><span class="base">邪魔</span
                ><rp>(</rp><rt>じゃま</rt><rp>)</rp
            ></ruby
            >させる</a
        ><a href="https://jisho.org/word/%E8%A8%B3%E3%81%AB%E3%81%AF%E3%81%84%E3%81%8B%E3%81%AA%E3%81%84"
            >ワケにはいかない</a
        ><a href="https://jisho.org/word/%E3%81%8B%E3%82%89"
            >から</a>
    <p>I won't let anyone get in my way

    <p class="jp">
        <a href="https://jisho.org/word/%E6%9E%9C%E5%AE%9F"
            ><ruby
                ><span class="base">果実</span
                ><rp>(</rp><rt>かじつ</rt><rp>)</rp
            ></ruby
        ></a
        ><a href="https://jisho.org/word/%E3%81%8C"
            >が</a
        ><a href="https://jisho.org/word/%E5%91%8A%E3%81%92%E3%82%8B"
            ><ruby
                ><span class="base">告</span
                ><rp>(</rp><rt>つ</rt><rp>)</rp
            ></ruby
            >げた</a
        ><a href="https://jisho.org/word/%E6%9C%AA%E6%9D%A5"
            ><ruby
                ><span class="base">未来</span
                ><rp>(</rp><rt>みらい</rt><rp>)</rp
            ></ruby
        ></a
        ><a href="https://jisho.org/word/%E5%A4%A2"
            ><ruby
                ><span class="base">夢,</span
                ><rp>(</rp><rt>ゆめ</rt><rp>)</rp
            ></ruby
        ></a
        ><a href="https://jisho.org/word/%E7%90%86%E6%83%B3"
            ><ruby
                ><span class="base">理想</span
                ><rp>(</rp><rt>りそう</rt><rp>)</rp
            ></ruby
        ></a
        ><a href="https://jisho.org/word/%E3%81%AB"
            >に</a
        ><a href="https://jisho.org/word/%E5%A4%89%E3%81%88%E3%82%8B"
            ><ruby
                ><span class="base">変</span
                ><rp>(</rp><rt>か</rt><rp>)</rp
            ></ruby
            >える</a>
    <p>The recent past tells me of the future. My ideals become my dreams.

    <p class="jp">
        <a href="https://jisho.org/word/%E8%AA%B0"
            ><ruby
                ><span class="base">誰</span
                ><rp>(</rp><rt>だれ</rt><rp>)</rp
            ></ruby
        ></a
        ><a href="https://jisho.org/word/%E3%82%82"
            >も</a
        ><a href="https://jisho.org/word/%E3%81%8C"
            >が</a
        ><a href="https://jisho.org/word/%E6%9C%9B%E3%82%80"
            ><ruby
                ><span class="base">望</span
                ><rp>(</rp><rt>のぞ</rt><rp>)</rp
            ></ruby
            >んだ</a
        >「<a href="https://jisho.org/word/%E7%B5%82%E5%B9%95"
            ><ruby
                ><span class="base">終幕</span
                ><rp>(</rp><rt>おわる</rt><rp>)</rp
            ></ruby
        ></a
        >」<a href="https://jisho.org/word/%E3%82%92"
          >を･･･</a>
    <p>The ending that everyone desires.

    <p class="jp">
        <a href="https://jisho.org/word/%E5%BA%83%E3%81%8C%E3%82%8B"
            ><ruby
                ><span class="base">広</span
                ><rp>(</rp><rt>ひろ</rt><rp>)</rp
            ></ruby
            >がる</a
        ><a href="https://jisho.org/word/%E9%97%87"
            ><ruby
                ><span class="base">闇</span
                ><rp>(</rp><rt>やみ</rt><rp>)</rp
            ></ruby
        ></a
        ><a href="https://jisho.org/word/%E3%81%AE"
            >の</a
        ><a href="https://jisho.org/word/%E4%B8%AD"
            ><ruby
                ><span class="base">中</span
                ><rp>(</rp><rt>なか</rt><rp>)</rp
            ></ruby
        ></a
        ><a href="https://jisho.org/word/%E4%BA%A4%E3%82%8F%E3%81%97%E5%90%88%E3%81%86"
            ><ruby
                ><span class="base">交</span
                ><rp>(</rp><rt>か</rt><rp>)</rp
            ></ruby
            >わし<ruby
                ><span class="base">合</span
                ><rp>(</rp><rt>あ</rt><rp>)</rp
            ></ruby
            >った</a
        ><a href="https://jisho.org/word/%E9%9D%A9%E5%91%BD"
            ><ruby
                ><span class="base">革命</span
                ><rp>(</rp><rt>かくめい</rt><rp>)</rp
            ></ruby
        ></a
        ><a href="https://jisho.org/word/%E3%81%AE"
            >の</a
        ><a href="https://jisho.org/word/%E5%A5%91%E3%82%8A"
            ><ruby
                ><span class="base">契</span
                ><rp>(</rp><rt>ちぎ</rt><rp>)</rp
            ></ruby
            >り</a>
    <p>In the shadows that keep expanding, we exchange revolutionary vows.

    <p class="jp">
        <a href="https://jisho.org/word/%E8%AA%B0"
            ><ruby
                ><span class="base">誰</span
                ><rp>(</rp><rt>だれ</rt><rp>)</rp
            ></ruby
        ></a
        ><a href="https://jisho.org/word/%E3%81%AB"
            >に</a
        ><a href="https://jisho.org/word/%E3%82%82"
            >も</a
        ><a href="https://jisho.org/word/%E9%82%AA%E9%AD%94"
            ><ruby
                ><span class="base">邪魔</span
                ><rp>(</rp><rt>じゃま</rt><rp>)</rp
            ></ruby
            >させる</a
        ><a href="https://jisho.org/word/%E8%A8%B3%E3%81%AB%E3%81%AF%E3%81%84%E3%81%8B%E3%81%AA%E3%81%84"
            >ワケにはいかない</a>
    <p>I won't let anyone get in my way

    <p class="jp">
        <a href="https://jisho.org/word/%E4%BD%95%E6%99%82%E3%81%8B"
            >いつか</a
        ><a href="https://jisho.org/word/%E5%83%95-1"
            ><ruby
                ><span class="base">僕</span
                ><rp>(</rp><rt>ぼく</rt><rp>)</rp
            ></ruby
        ></a
        ><a href="https://jisho.org/word/%E3%81%8C"
            >が</a
        ><a href="https://jisho.org/word/%E8%A6%8B%E3%81%9B%E3%82%8B"
            ><ruby
                ><span class="base">見</span
                ><rp>(</rp><rt>み</rt><rp>)</rp
            ></ruby
            >せてあげる</a
        ><a href="https://jisho.org/word/%E5%85%89%E3%82%8A%E8%BC%9D%E3%81%8F"
            ><ruby
                ><span class="base">光</span
                ><rp>(</rp><rt>ひか</rt><rp>)</rp
            ></ruby
            >り<ruby
                ><span class="base">輝</span
                ><rp>(</rp><rt>かがや</rt><rp>)</rp
            ></ruby
            >く</a
        ><a href="https://jisho.org/word/%E4%B8%96%E7%95%8C"
            ><ruby
                ><span class="base">世界</span
                ><rp>(</rp><rt>せかい</rt><rp>)</rp
            ></ruby
        ></a
        ><a href="https://jisho.org/word/%E3%82%92"
            >を</a>
    <p>Someday I'll show you a world that shines in the light.

    <script>
        const data = {};
        data['jp'] = Array.from(document.querySelectorAll('p.jp'))
            .map(p =>
                Array.from(p.querySelectorAll('a'))
                    .map(a => Array.from(a.childNodes)
                        .map(n => n.nodeType == Node.TEXT_NODE
                            ? n.nodeValue
                            : [n.querySelector('span.base').textContent,
                               n.querySelector('rt').textContent]))
            );
        data['en'] = [
            ["spread out","darkness",,"inside","exchanged","revolution",,"vow"],
            ["anybody",,,"let get in one's way","cannot"],
            ["fruit",,"told","future","dream","ideal",,"change"],
            ["everybody",,,"wanted","end"],
            ["spread out","darkness",,"inside","exchanged","revolution",,"vow"],
            ["anybody",,,"let get in one's way","cannot"],
            ["someday","I",,"show","shine","world"]
        ];

        function switchToHiragana() {
            Array.from(document.querySelectorAll('p.jp'))
                .forEach((p, i) =>
                    Array.from(p.querySelectorAll('a'))
                        .forEach((a, j) => {
                            a.innerHTML = data['jp'][i][j]
                                .map(el => Array.isArray(el) && el[1]
                                    ? '<ruby>'
                                        + `<span class="base">${el[0]}</span>`
                                        + `<rp>(</rp><rt>${el[1]}</rt><rp>)</rp>`
                                    + '</ruby>'
                                : Array.isArray(el)
                                    ? el[0]
                                : el).join('')
                        })
                );
        }

        function switchToTranslations() {
            Array.from(document.querySelectorAll('p.jp'))
                .forEach((p, i) =>
                    Array.from(p.querySelectorAll('a'))
                        .forEach((a, j) => {
                            const word = data['jp'][i][j]
                                .map(el => Array.isArray(el) ? el[0] : el)
                                .join('');
                            a.innerHTML = data['en'][i][j]
                                ? '<ruby>'
                                    + `<span class="base">${word}</span>`
                                    + `<rp>(</rp><rt>${data['en'][i][j]}</rt><rp>)</rp>`
                                + '</ruby>'
                                : word;
                        }));
        }

        const hiraganaEl = document.querySelector('[name=ruby][value=hiragana]');
        hiraganaEl.addEventListener('click', switchToHiragana);
        const translationEl = document.querySelector('[name=ruby][value=translation]');
        translationEl.addEventListener('click', switchToTranslations);
        if (![hiraganaEl, translationEl].some(el => el.checked))
            hiraganaEl.click();
    </script>
</body>
</html>
